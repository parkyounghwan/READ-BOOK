# 2021-03-05

## IOC 컨테이너: 빈 팩토리와 애플리케이션 컨텍스트

스프링 애플리케이션에서는 오브젝트의 생성과 관계설정, 사용, 제거 등의 작업을 애플리케이션 코드 대신 독립된 컨테니어가 담당한다. 이를 컨테이너가 코드 대신 오브젝트에 대한 제어권을 갖고있다고 해서 IoC라고 부른다. 그래서 스프링 컨테이너를 IoC컨테이너라고도 한다.

Ioc컨테이너 = 빈팩토리 = 애플리케이션 컨텍스트

단순히 DI 관점으로 볼 때는 컨테이너를 빈 팩토리라고 하지만 애플리케이션을 개발하는데 필요한 여러 가지 컨테이너 기능을 추가한 것을 애플리케이션 컨택스트라고 부른다. 즉, Ioc와 DI를 위한 빈팩토리이면서 그 이상의 기능을 가졌다.

### IoC 컨테이너를 이용해 애플리케이션 만들기

POJO클래스

애플리케이션의 핵심 코드를 가진 POJO클래스를 만들어야 한다. 각각의 POJO는 특정 기술과 스펙에서 독립적일뿐더러 의존관계에 있는 다른 POJO와 느슨한 결합을 갖도록 만들어야한다.

![image](https://user-images.githubusercontent.com/39057317/110123545-5e2e6580-7e04-11eb-87e2-1bab00169cc1.png)

POJO의 클래스 다이어그램

Hello라는 클래스와 StringPrinter, ConsolePrinter는 Printer라는 인터페이스로 느슨하게 연결되어 있다.

구체적으로 서로의 이름과 존재를 알 필요없이 Printer라는 인터페이스의 존재만 알면 된다.

Hello는 Printer라는 인터페이스를 구현한 클래스의 오브젝트라면 어떤 것이든 사용 가능하다.

POJO코드를 설계할 때는 유연한 변경 가능성을 고려해서 만든다.

각자 기능에 충실하게 독립적으로 설계된 POJO 클래스를 만들고, 결합도가 낮은 유연한 관계를 가질 수 있도록 인터페이스를 이용해 연결해주는 것까지가 IoC컨테이너가 사용할 POJO를 준비하는 첫 단계이다.

## 설정 메타정보

IoC 컨테이너의 가장 기초적인 역할은 오브젝트를 생성하고 이를 관리하는 것이다. 스프링 컨테이너가 관리하는 이런 오브젝트를 **빈\(Bean\)** 이라고 부른다.

IoC컨테이너가 필요로 하는 설정 메타정보는 바로 이 빈을 어떻게 만들고 어떻게 동작하게 할 것인가에 관한 정보다. 스프링의 설정 메타정보는 XML 파일이 아니다.

스프링의 설정 메타정보는 BeanDefinition 인터페이스로 표현되는 순수한 추상정보다.

스프링 IoC 컨테이너, 즉 애플리케이션 컨텍스트는 바로 이 BeanDefinition으로 만들어진 메타정보를 담은 오브젝트를 사용해 IoC와 DI 작업을 수행한다. 따라서 스프링의 메타정보는 특정한 파일 포맷이나 형식에 제한되거나 종속되지 않는다. XML, 소스코드 애노테이션, 자바 코드, 프로퍼티 파일 무엇이든 사용가능하다.

BeanDefinition 인터페이스로 정의되는, IoC 컨테이너가 사용하는 빈 메타정보는 아래와 같다.

* 빈아이디, 이름, 별칭 : 빈 오브젝트를 구분할 수 있는 식별자
* 클래스 또는 클래스 이름 : 빈으로 만들 POJO 클래스 또는 서비스 클래스 정보
* 스코프 : 싱글톤, 프로토타입과 같은 빈의 생성 방식과 존재범위
* 프로퍼티 값 또는 참조 : DI에 사용할 프로퍼티 이름과 값 또는 참조하는 빈의 이름
* 생성자 파라미터 값 또는 참조 : DI에 사용할 생성자 파라미터 이름과 값 또는 참조할 빈의 이름
* 지연된 로딩 여부, 우선 빈 여부, 자동와이어링 여부, 부모 빈 정보, 빈팩토리 이름 등

스프링 IoC컨테이너는 각 빈에 대한 정보를 담은 설정 메타정보를 읽어들인 뒤에, 이를 참고해서 빈 오브젝트를 생성하고 프로퍼티나 생성자를 통해 의존 오브젝트를 주입해주는 DI작업을 수행한다.

DI로 연결되는 오브젝트들이 모여서 하나의 애플리케이션을 구성하고 동작하게 된다. IoC컨테이너의 역할은 바로 이것이다. IoC컨테이너를 통해 POJO클래스와 설정 메타정보가 결합되어 하나의 애플리케이션이 만들어진다.

![image](https://user-images.githubusercontent.com/39057317/110126169-7fdd1c00-7e07-11eb-9f16-12e94f1dc5c9.png)

