# 2021-05-01

**활성 프로파일 지정방법**

특정 프로파일에 정의된 빈을 사용하고 싶으면 해당 프로파일을 활성 프로파일로 만들어주면 된다. 프로파일 관련 정보는 Environment 타입의 오브젝트가 갖고 있다. Environment 오브젝트는 애플리케이션 컨텍스트에서 가져올 수 있다. Environment 오브젝트에는 활성 프로파일 정보를 지정할 수 있는 setActiveProfiles\(\) 메소드가 있는데 여기에 사용할 프로파일 이름을 넣어주면 된다.

활성 프로파일을 지정할 시스템 프로퍼티 이름은 spring.profiles.active다. WAS 시동 스크립트에서 환경변수 spring.profiles.active에 dev를 넣고WAS를 시작하면 dev 활성 프로파일이 적용되면서 컨텍스트가 만들어질 것이다.

활성 프로파일을 지정하는 방법이 여러 가지 있는데, 두 개 이상의 방법을 동시에 사용하면 우선순위가 가장 높은 방법으로 지정한 것이 적용된다. 서블릿 초기화 파라미터인 을 사용한 것이 가장 우선순위가 높다.

**프로파일 활용 전략**

프로파일을 다양한 방식으로 나눠서 사용하는 경우에는 활성 프로파일을 지정할 때 애플리케이션이 바르게 동작하는 데 필요한 빈이 모두 포함되는지 유의해야 한다.

프로파일별로 어떤 빈을 조합해서 넣을지는 자유지만 프로파일 외부의 빈과 의존관계가 형성되는 경우에는 의존관계가 깨지지 않도록 주의해야 한다.

@Configuration이 붙은 클래스를 이용해 빈을 정의하는 경우에도 프로파일을 지정할 수 있다. @Profile 애노테이션을 사용해 해당 클래스에 정의된 빈이 적용될 프로파일 이름을 지정해주면 된다.

AnnotationConfigWebApplicationContext를 사용해 @Configuration 클래스를 설정 메타정보로 사용하려면 클래스의 위치를 contextConfigLocation으로 지정한다. 이때 contextConfigLocation을 패키지 레벨로 지정하면 패키지 내의 클래스 중에 @Configuration이 붙은 것이 적용 후보가 된다.

## 프로퍼티 소스

DB 연결정보처럼 환경에 따라서 달라지는 것은 빈 메타정보에 두기보다는 프로파일 파일 같은 별도의 리소스를 사용해 분리하는 편이 바람직하다.

프로파일을 적용한 경우에도 필요에 따라 와 ${} 치환자를 사용해 파일로부터 프로퍼티 정보를 가져오게 한 것이다.

**프로퍼티**

자바에서 말하는 프로퍼티는 기본적으로 키와 그에 대응되는 값의 쌍을 말한다.

스프링의 XML에서는 의 name과 value 애트리뷰트를 이요해 프로퍼티 정보를 표현한다. 프로퍼티 파일은 텍스트 파일포맷으로 되어 있다.

Properties사 기본적으로 지원하는 프로퍼티 파일은 ISO-8859-1 인코딩만을 지원하기 때문에 영문만 사용할 수 있다. 따라서 영어가 아닌 문자는 사용할 수 없다.

