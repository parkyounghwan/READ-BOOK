# REPOSITORY

개발자들은 캡슐화된 행위를 활용한 것에 내포된 의미를 잘 알아야 한다. 구현의 상세 내용을 알아야한다는 것은 아니다. 구현 세부사항에 대한 착각으로 생각하지 못한 문제가 발생할 수도 있다. 잘 설계된 컴포넌트는 구현의 특징이 잘 드러난다.

구현은 영속화에 사용되는 기술과 인프라스트럭처에 따라 달라진다. 하지만 클라이언트에게 구현 세부사항을 감추어, 데이터가 객체 데이터베이스나 관계형 데이터베이스에 저장되는지, 메모리에 상주하는지에 상관없이 동일한 코드를 작성하도록 해야한다.

REPOSITORY 구현을 할 때 기억해야하는 3가지 사항이 있다. 타입을 추상화해야 하고, 클라이언트와 분리를 해야하고, 트랜잭션 제어를 클라이언트에게 맡겨야 한다는 것이다.

REPOSITORY 구현에 앞서 REPOSITORY가 구현된 프레임워크가 있는지 확인을 해야한다. 사용중인 프레임워크를 억지로 도메인 주도 설계에 맞추지 말고, 도메인 주도 설계와 프레임워크 개념이 유사한 프레임워크르 찾아야 한다.

FACTORY와 REPOSITORY가 객체를 생성한다는 유사점이 있지만 다른 개념이다. FACTORY는 객체 생명주기의 초기 단계를 다루고 REPOSITORY는 객체 생명주기의 중간과 마지막 단계를 다룬다. 도메인 주도 설계 관점에서 객체 재구성은 객체 생성과는 다른 개념이다. FACTORY는 객체를 생성하지만, REPSOITORY는 기존 객체를 찾아내어 재구성한다. REPOSITORY에서 생성 책임을 가지는 경우에는 FACTORY에게 위임하여 처리할 수도 있다. FACTORY에서 영속화에 대한 모든 책임을 제거하여 FACTORY와 REPOSITORY의 명확한 분리를 하는 게 좋다.

